<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu Perfil - Sentinela 360</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: white;
            font-family: 'Arial', sans-serif;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .app-screen {
            width: 100%;
            max-width: 400px;
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .app-header {
            background-color: #fff;
            text-align: center;
            padding: 20px 20px 10px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .logo-container {
            margin-bottom: 15px;
        }
        
        .back-button {
            position: absolute;
            left: 20px;
            top: 20px;
            background: none;
            border: none;
            font-size: 24px;
            color: #0e0446;
            cursor: pointer;
        }
        
        .page-title {
            font-size: 24px;
            font-weight: bold;
            color: #0e0446;
            margin-bottom: 5px;
        }
        
        .page-subtitle {
            font-size: 14px;
            color: #666;
        }
        
        .profile-section {
            padding: 20px;
        }
        
        .section-title {
            font-size: 18px;
            font-weight: bold;
            color: #0e0446;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .btn-primary-custom {
            background-color: #0e0446;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 12px 20px;
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn-primary-custom:hover {
            background-color: #1a0b6e;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(14, 4, 70, 0.2);
        }
        
        .btn-primary-custom i {
            margin-right: 10px;
            font-size: 18px;
        }
        
        .guardians-section {
            margin-top: 10px;
        }
        
        .guardian-item {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 12px;
            border: 1px solid #eaeaea;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
        }
        
        .guardian-item:hover {
            background-color: #f0f2f5;
            transform: translateY(-2px);
        }
        
        .guardian-info {
            flex-grow: 1;
        }
        
        .guardian-name {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 3px;
        }
        
        .guardian-phone {
            font-size: 14px;
            color: #666;
        }
        
        .guardian-actions {
            display: flex;
            gap: 10px;
        }
        
        .action-btn {
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            padding: 5px;
            border-radius: 5px;
            transition: all 0.2s ease;
        }
        
        .edit-btn {
            color: #3498db;
        }
        
        .edit-btn:hover {
            background-color: rgba(52, 152, 219, 0.1);
        }
        
        .delete-btn {
            color: #e74c3c;
        }
        
        .delete-btn:hover {
            background-color: rgba(231, 76, 60, 0.1);
        }
        
        .add-guardian-form {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid #eaeaea;
            display: none;
        }
        
        .form-title {
            font-size: 16px;
            font-weight: 600;
            color: #0e0446;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }
        
        .form-input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.2s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #0e0446;
            box-shadow: 0 0 0 2px rgba(14, 4, 70, 0.1);
        }
        
        .form-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn-save {
            background-color: #2ecc71;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 15px;
            font-size: 14px;
            font-weight: 600;
            flex: 1;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .btn-save:hover {
            background-color: #27ae60;
        }
        
        .btn-cancel {
            background-color: #e74c3c;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 15px;
            font-size: 14px;
            font-weight: 600;
            flex: 1;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .btn-cancel:hover {
            background-color: #c0392b;
        }
        
        .empty-state {
            text-align: center;
            padding: 30px 20px;
            color: #666;
        }
        
        .empty-state i {
            font-size: 48px;
            color: #ddd;
            margin-bottom: 15px;
        }
        
        .empty-state p {
            font-size: 14px;
        }
        
        .back-bottom-section {
            text-align: center;
            padding: 15px 20px 20px;
            background-color: #f8f9fa;
            border-top: 1px solid #eaeaea;
            margin-top: 20px;
        }
        
        .back-button-bottom {
            background-color: #0e0446;
            color: white;
            border: none;
            border-radius: 50px;
            padding: 15px 30px;
            font-size: 18px;
            font-weight: bold;
            width: 100%;
            max-width: 280px;
            cursor: pointer;
            display: inline-block;
            transition: all 0.3s ease;
        }
        
        .back-button-bottom:hover {
            background-color: #1a0b6e;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(14, 4, 70, 0.2);
        }
        
        /* Responsividade */
        @media (max-width: 480px) {
            .app-screen {
                max-width: 100%;
                border-radius: 15px;
            }
            
            .profile-section {
                padding: 15px;
            }
            
            .back-button-bottom {
                padding: 14px 25px;
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="app-screen">
        <div class="app-header">
            <button class="back-button" id="backButton">
                <i class="bi bi-arrow-left"></i>
            </button>
            <div class="logo-container">
                <img src="logo.jpeg" style="width: 250px;">
            </div>
            <div class="page-title">Meu Perfil</div>
            <div class="page-subtitle">Gerencie suas configurações de segurança</div>
        </div>
        
        <div class="profile-section">
            <!-- Botão para cadastrar rotas rotineiras -->
            <div class="section-title">Rotas Rotineiras</div>
            <button class="btn-primary-custom" id="addRouteBtn">
                <i class="bi bi-geo-alt"></i>
                Cadastrar Nova Rota
            </button>
            
            <!-- Lista de Guardiões -->
            <div class="section-title">Guardiões</div>
            <div class="guardians-section">
                <div id="guardiansList">
                    <!-- Lista de guardiões será inserida aqui dinamicamente -->
                </div>
                
                <button class="btn-primary-custom" id="addGuardianBtn">
                    <i class="bi bi-person-plus"></i>
                    Adicionar Guardião
                </button>
            </div>
            
            <!-- Formulário para adicionar guardião -->
            <div class="add-guardian-form" id="guardianForm">
                <div class="form-title">Adicionar Guardião</div>
                <div class="form-group">
                    <label class="form-label" for="guardianName">Nome do Guardião</label>
                    <input type="text" class="form-input" id="guardianName" placeholder="Digite o nome completo">
                </div>
                <div class="form-group">
                    <label class="form-label" for="guardianPhone">Telefone</label>
                    <input type="tel" class="form-input" id="guardianPhone" placeholder="(61) 99999-9999">
                </div>
                <div class="form-buttons">
                    <button class="btn-save" id="saveGuardianBtn">Salvar</button>
                    <button class="btn-cancel" id="cancelGuardianBtn">Cancelar</button>
                </div>
            </div>
        </div>
        
        <!-- Botão de Voltar -->
        <div class="back-bottom-section">
            <button class="back-button-bottom" id="backButtonBottom">
                <i class="bi bi-arrow-left"></i> Voltar para Tela Principal
            </button>
        </div>
    </div>

    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Voltar para a página principal (botão superior)
        document.getElementById('backButton').addEventListener('click', function() {
            window.location.href = 'index.html';
        });
        
        // Voltar para a página principal (botão inferior)
        document.getElementById('backButtonBottom').addEventListener('click', function() {
            window.location.href = 'index.html';
        });
        
        // Botão para cadastrar rotas rotineiras
        document.getElementById('addRouteBtn').addEventListener('click', function() {
            alert('Funcionalidade de cadastro de rotas rotineiras!\n\nEm uma versão completa, esta funcionalidade permitiria:\n1. Definir rotas que você faz frequentemente\n2. Estabelecer horários esperados\n3. Receber alertas se desviar da rota\n4. Compartilhar rotas com seus guardiões');
        });
        
        // Variáveis para gerenciar guardiões
        // Já inicializa com os dois contatos pré-cadastrados
        let guardians = JSON.parse(localStorage.getItem('sentinelaGuardians')) || [
            { id: 1, name: 'Mãe', phone: '(61) 9999-8868' },
            { id: 2, name: 'Condomínio', phone: '(61) 3554-9986' }
        ];
        
        // Se não tinha guardiões salvos, salva os padrões
        if (!localStorage.getItem('sentinelaGuardians')) {
            localStorage.setItem('sentinelaGuardians', JSON.stringify(guardians));
        }
        
        let editingGuardianId = null;
        
        // Elementos do DOM
        const guardiansList = document.getElementById('guardiansList');
        const addGuardianBtn = document.getElementById('addGuardianBtn');
        const guardianForm = document.getElementById('guardianForm');
        const saveGuardianBtn = document.getElementById('saveGuardianBtn');
        const cancelGuardianBtn = document.getElementById('cancelGuardianBtn');
        const guardianNameInput = document.getElementById('guardianName');
        const guardianPhoneInput = document.getElementById('guardianPhone');
        
        // Mostrar/ocultar formulário de guardião
        addGuardianBtn.addEventListener('click', function() {
            guardianForm.style.display = 'block';
            addGuardianBtn.style.display = 'none';
            editingGuardianId = null;
            guardianNameInput.value = '';
            guardianPhoneInput.value = '';
        });
        
        cancelGuardianBtn.addEventListener('click', function() {
            guardianForm.style.display = 'none';
            addGuardianBtn.style.display = 'block';
            guardianNameInput.value = '';
            guardianPhoneInput.value = '';
            editingGuardianId = null;
        });
        
        // Salvar guardião
        saveGuardianBtn.addEventListener('click', function() {
            const name = guardianNameInput.value.trim();
            const phone = guardianPhoneInput.value.trim();
            
            if (!name) {
                alert('Por favor, informe o nome do guardião.');
                return;
            }
            
            if (!phone) {
                alert('Por favor, informe o telefone do guardião.');
                return;
            }
            
            if (editingGuardianId !== null) {
                // Editar guardião existente
                guardians = guardians.map(g => {
                    if (g.id === editingGuardianId) {
                        return { ...g, name, phone };
                    }
                    return g;
                });
            } else {
                // Adicionar novo guardião
                const newGuardian = {
                    id: Date.now(),
                    name,
                    phone
                };
                guardians.push(newGuardian);
            }
            
            // Salvar no localStorage
            localStorage.setItem('sentinelaGuardians', JSON.stringify(guardians));
            
            // Atualizar a lista
            renderGuardiansList();
            
            // Limpar formulário e ocultar
            guardianNameInput.value = '';
            guardianPhoneInput.value = '';
            guardianForm.style.display = 'none';
            addGuardianBtn.style.display = 'block';
            editingGuardianId = null;
            
            // Mostrar mensagem de sucesso
            alert(editingGuardianId !== null ? 'Guardião atualizado com sucesso!' : 'Guardião adicionado com sucesso!');
        });
        
        // Editar guardião
        function editGuardian(id) {
            const guardian = guardians.find(g => g.id === id);
            if (guardian) {
                guardianNameInput.value = guardian.name;
                guardianPhoneInput.value = guardian.phone;
                editingGuardianId = id;
                guardianForm.style.display = 'block';
                addGuardianBtn.style.display = 'none';
            }
        }
        
        // Excluir guardião
        function deleteGuardian(id) {
            // Impede a exclusão dos contatos padrão
            if (id === 1 || id === 2) {
                alert('Este é um contato padrão e não pode ser removido.');
                return;
            }
            
            if (confirm('Tem certeza que deseja remover este guardião?')) {
                guardians = guardians.filter(g => g.id !== id);
                localStorage.setItem('sentinelaGuardians', JSON.stringify(guardians));
                renderGuardiansList();
                alert('Guardião removido com sucesso!');
            }
        }
        
        // Renderizar lista de guardiões
        function renderGuardiansList() {
            if (guardians.length === 0) {
                let emptyState = document.createElement('div');
                emptyState.className = 'empty-state';
                emptyState.innerHTML = `
                    <i class="bi bi-people"></i>
                    <p>Nenhum guardião cadastrado ainda.</p>
                    <p>Adicione contatos de confiança para notificar em emergências.</p>
                `;
                guardiansList.innerHTML = '';
                guardiansList.appendChild(emptyState);
                return;
            }
            
            let html = '';
            guardians.forEach(guardian => {
                // Verifica se é um contato padrão (não pode ser excluído)
                const isDefault = guardian.id === 1 || guardian.id === 2;
                
                html += `
                    <div class="guardian-item">
                        <div class="guardian-info">
                            <div class="guardian-name">${guardian.name}</div>
                            <div class="guardian-phone">${guardian.phone}</div>
                        </div>
                        <div class="guardian-actions">
                            <button class="action-btn edit-btn" onclick="editGuardian(${guardian.id})">
                                <i class="bi bi-pencil"></i>
                            </button>
                            ${!isDefault ? `
                                <button class="action-btn delete-btn" onclick="deleteGuardian(${guardian.id})">
                                    <i class="bi bi-trash"></i>
                                </button>
                            ` : `
                                <button class="action-btn delete-btn" style="opacity: 0.3; cursor: not-allowed;" title="Contato padrão não pode ser removido">
                                    <i class="bi bi-trash"></i>
                                </button>
                            `}
                        </div>
                    </div>
                `;
            });
            
            guardiansList.innerHTML = html;
        }
        
        // Formatação automática do telefone
        guardianPhoneInput.addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            
            if (value.length > 10) {
                value = value.replace(/^(\d{2})(\d{5})(\d{4}).*/, '($1) $2-$3');
            } else if (value.length > 6) {
                value = value.replace(/^(\d{2})(\d{4})(\d{0,4}).*/, '($1) $2-$3');
            } else if (value.length > 2) {
                value = value.replace(/^(\d{2})(\d{0,5})/, '($1) $2');
            } else if (value.length > 0) {
                value = value.replace(/^(\d*)/, '($1');
            }
            
            e.target.value = value;
        });
        
        // Inicializar a lista de guardiões
        renderGuardiansList();
        
        // Disponibilizar funções globalmente para os eventos onclick
        window.editGuardian = editGuardian;
        window.deleteGuardian = deleteGuardian;
    </script>
</body>
</html>